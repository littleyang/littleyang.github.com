<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/Blog">
<head>
    <meta charset="UTF-8" />
    <meta name="application-name" content="Looking-Glass" />
    <meta name="author" content="LittleYang" />
    <meta name="generator" content="Jekyll 0.12.0" />
    <meta name="description" content="" />
    <meta name="keywords" content="" />

    <meta itemprop="name" content="Jekyll 0.12.0新特性简介">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="" />

    <title>Jekyll 0.12.0新特性简介</title>

    <link rel="alternate" type="application/atom+xml" href="/atom.xml" />
    <link rel="icon" type="image/vnd.microsoft.icon" href="/favicon.ico" sizes="57x57" />

    <link rel="author" type="text/html" href="https://plus.google.com/100974147585154622588/about" />
    <link rel="license" type="text/html" href="http://creativecommons.org/licenses/by-sa/3.0/" />

    <!-- Google Web Fonts (not in use) -->
    <!-- link rel='stylesheet' type='text/css' href='http://fonts.googleapis.com/css?family=Droid+Sans' / -->

    <link rel="stylesheet" type="text/css" href="/~css/main.css" media="all" />
    <link rel="stylesheet" type="text/css" href="/~css/mobile.css" media="all and (max-width:1023px)" />

    <!-- Pygments -->
    <link rel="stylesheet" type="text/css" href="/~css/pygments.css" media="all" />

    <!-- Highlight.js -->
    <link rel="stylesheet" href="/~css/tomorrow-night.min.css">
    <script src="/~js/highlight.pack.js"></script>
    <!-- script>hljs.initHighlightingOnLoad();</script -->

    <!-- jQuery & Galleria -->
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.js"></script>
    <script src="/~plugins/galleria/galleria-1.2.8.min.js"></script>

    <!-- MathJax (not in use) -->
    <!-- script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
        });
    </script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script -->

    <!-- ShareThis (not in use) -->
    <!-- script type="text/javascript" src="http://w.sharethis.com/button/buttons.js"></script>
    <script type="text/javascript">stLight.options({publisher: "9aabed9c-ac3f-4f96-8f5a-8e7a27307543"}); </script -->

    <!-- Google Analytics -->
    <script type="text/javascript">
        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-27086900-1']);
        _gaq.push(['_setDomainName', '.soimort.org']);
        _gaq.push(['_trackPageview']);
        (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();
    </script>

    <script type="text/javascript" src="/~js/main.js"></script>

</head>

<body>
    <!-- load background image (must be put in body) -->
    <script type="text/javascript">
        document.body.style.backgroundImage = "url('http://i.imgur.com/0eQ5v.jpg')";
    </script>

    <nav id="navBarTop">
        <ul class="navBarListLeft">
            <li><a href="/"><img src="/~images/home.png" alt="home" title="Home" class="navDock" height="24" /></a></li>
            <li><a href="/atom.xml" target="_blank"><img src="/~images/feed.png" alt="feed" title="Feed" class="navDock" height="24" /></a></li>
        </ul>

        <ul class="navBarListRight">
            <li style="position: relative; top: -5px"><b>LittleYang</b> on </li>
            <!-- Google+ --><li><a href="https://plus.google.com/107586052733788098083/" target="_blank"><img src="https://ssl.gstatic.com/images/icons/gplus-32.png" alt="gplus" title="Google+" class="navDock" height="24" /></a></li>
            <!-- Twitter --><li><a href="https://twitter.com/soimort" target="_blank"><img src="/~images/twitter.png" alt="twitter" title="Twitter" class="navDock" height="24" /></a></li>
            <!-- Facebook --><!-- li><a href="https://www.facebook.com/soimort" target="_blank"><img src="/~images/facebook.png" alt="facebook" title="Facebook" class="navDock" height="24" /></a></li -->
            <!-- deviantArt --><li><a href="http://soimort.deviantart.com" target="_blank"><img src="/~images/deviantart.png" alt="deviantart" title="deviantART" class="navDock" height="24" /></a></li>
            <!-- GitHub --><li><a href="http://github.com/soimort" target="_blank"><img src="/~images/github.png" alt="github" title="GitHub" class="navDock" height="24" /></a></li>
        </ul>
    </nav>

    <nav id="navBarBottom">
        <div class="navBarListLeft">
            <div style="position: relative; top: 4px; width: 60%">
                © 2013 <a href="http://www.google.com" target="_blank"><b>Little Yang</b></a>. Under the <a href="http://creativecommons.org/licenses/by-sa/3.0/" target="_blank"><b>CC BY-SA 3.0 License</b></a>.
            </div>
        </div>

        <div class="navBarListRight">
            <div style="position: relative; top: 4px; right: 0">
                 |Powered by <a href="http://jekyllrb.com/" target="_blank"><b>Jekyll</b></a>
            </div>
        </div>
    </nav>

    <div id="divTitle">
    <h1>Jekyll 0.12.0新特性简介</h1>
    <p><div class="g-plusone" data-size="medium" data-annotation="none"></div></p>
    <p><b>28 Dec 2012</b>, by <b>Mort</b></p>
    <p></p>
    <div id="divTitleNav">
        <a href="/"><img src="/~images/left-arrow.png" class="navDock" /></a>
    </div>
</div>

<div id="divPost">
    <article id="articlePost">
        <p>GitHub的静态博客系统<a href="http://jekyllrb.com/">Jekyll</a>最近终于发布<a href="http://rubygems.org/gems/jekyll/versions/0.12.0">新版本（0.12.0）</a>了！<img src="http://static.tieba.baidu.com/tb/editor/images/tsj/t_0035.gif" alt=""></p>

<p>（这个项目已经不知道多久没有更新，我差点都以为GitHub不打算把它继续维护下去了……）</p>

<p>所以，现在就来尝尝鲜，看看0.12.0版到底增加了哪些新东西。＼(^o^)／</p>

<h2>1. 支持Redcarpet 2渲染引擎</h2>

<p>Jekyll 0.12.0现在支持使用<a href="https://github.com/vmg/redcarpet">Redcarpet</a>，来作为替代RDiscount或Maruku的Markdown渲染引擎。</p>

<p>Redcarpet是由GitHub自己人开发的（我就不说质量有保证之类的话了），一直以来它被用于在GitHub上渲染Markdown格式文本（也就是<a href="http://github.github.com/github-flavored-markdown/">GitHub Flavored Markdown</a>）。由于API兼容性的原因，Jekyll以前的版本并不支持Redcarpet（所以以前写博客也不能用GitHub Flavored Markdown &gt;_&lt;）。现在，Jekyll 0.12.0终于增加了对Redcarpet 2引擎的支持，只需安装：</p>
<div class="highlight"><pre><code class="text">$ gem install redcarpet
</code></pre></div>
<p>把<code>_config.yml</code>中的Markdown引擎设置从：</p>
<div class="highlight"><pre><code class="text">markdown: rdiscount
</code></pre></div>
<p>改为：</p>
<div class="highlight"><pre><code class="text">markdown: redcarpet
</code></pre></div>
<p>就可以迁移到Redcarpet上了。</p>

<p>Redcarpet所支持的GitHub Flavored Markdown比起标准的Markdown语法来增加了不少便利之处，诸如<strong>围栏式代码块（Fenced code blocks）</strong>。</p>

<p>例如，在文章中嵌入一段Ruby代码块，对应的GitHub Flavored Markdown写法是：</p>

<pre><code class="no-highlight">```ruby
def ackermann(m, n)
    if m == 0
        n + 1
    elsif n == 0
        ackermann(m - 1, 1)
    else
        ackermann(m - 1, ackermann(m, n - 1))
    end
end
```
</code></pre>

<p>传统的标准Markdown中虽然可以嵌入代码块，但是无法声明所使用的程序语言。以前在Jekyll中，为了让Pygments正确识别并渲染一段高亮代码，需要借助于辅助的Liquid宏：{&#37; highlight ruby &#37;}{&#37; endhighlight &#37;}</p>

<p>现在，在Jekyll上也可以使用和GitHub Flavored Markdown相同的围栏式代码块了。</p>

<p><strong><del>注意：截止到目前（2012.12.28）为止，GitHub Pages服务器部署的似乎仍然是Jekyll 0.11.0。如果你的博客是托管在GitHub Pages上的，你将仍然无法使用GitHub Flavored Markdown（包括“围栏式代码块”）。</del></strong></p>

<p><strong>2013.1.3更新：GitHub Pages已经升级到了Jekyll 0.12.0：</strong><a href="https://github.com/blog/1366-github-pages-updated-to-jekyll-0-12-0">https://github.com/blog/1366-github-pages-updated-to-jekyll-0-12-0</a></p>

<h2>2. 用pygments.rb加速代码高亮（Syntax highlighting）</h2>

<p>Jekyll上用于渲染高亮代码的<a href="http://pygments.org/">Pygments</a>是一个Python库。以前，Jekyll 0.11.2使用<a href="https://github.com/github/albino">Albino</a>，一个Pygments的Ruby wrapper库来调用<code>pygmentize</code>渲染代码。</p>

<p>Albino直接从管道调用一个Python程序、等待其输出结果，然后将其返回，理所当然，它的执行速度很慢。事实上，它简直太tm慢了，慢到无法忍受，以至于许多人（包括我在内）后来都放弃了使用Pygments，直接拿<a href="http://softwaremaniacs.org/soft/highlight/en/">highlight.js</a>在前端上做代码高亮了。</p>

<p>Jekyll 0.12.0使用了<a href="https://github.com/tmm1/pygments.rb">pygments.rb</a>来取代Albino。pygments.rb同样是一个Pygments的Ruby wrapper，不同的是它会同时打开多个独立的Python子进程来分配给Ruby的进程调用（通过管道通信），这些子进程的生命期直到pygments.rb执行完毕才结束，这就避免了Ruby在执行过程中不断地启动和关闭Python解释器造成的不必要时间开销。<em>（这个原理非常有意思，以后如果要写在一种语言中调用另一种脚本语言的wrapper也许用得着）</em></p>

<p>Arch Linux用户注意：因为pygments.rb里面已经包含了Pygments，所以在新的Jekyll 0.12.0上不需要再依赖额外的python2-pygments包。此外，虽然Pygments有支持Python 3，不过pygments.rb里面打包进去的Pygments是Python 2版本的。需要手动修改<code>lib/pygments/mentos.py</code>的shebang。</p>

<p>升级到Jekyll 0.12.0之后，我特地对原来用的highlight.js和Pygments做了一个对比测试，来决定哪一种代码高亮工具更好用。详情请参见<a href="/posts/131/">下一篇文章</a>。</p>

<h2>3. 其他功能改进</h2>

<ul>
<li><p>增加了<code>include</code>设置参数，可以显式地指定哪些文件被Jekyll处理或忽略</p>

<ul>
<li>例如，以前Jekyll默认会忽略掉文件名前缀为下划线的文件，现在可以通过这个参数把它们也包含进来。</li>
</ul></li>
<li><p>增加了<code>--default-mimetype</code>选项</p>

<ul>
<li>当permalink没有<code>.html</code>后缀时，让WEBrick server也能正确识别mimetype。</li>
</ul></li>
<li><p>允许RedCloth选项的设定</p>

<ul>
<li>对于Textile用户来说应该会很有用。</li>
</ul></li>
<li><p>增加了Liquid标签<code>post_url</code>用来插入内部链接</p>

<ul>
<li>这个没觉得有太大用处。一般情况下似乎也用不着Liquid来插入链接……</li>
</ul></li>
<li><p>允许指定多个plugin文件夹</p>

<ul>
<li>对于用GitHub pages来托管的站点来说似乎意义不大（<a href="https://github.com/mojombo/jekyll/issues/325">基于安全考虑</a>，GitHub pages不执行任何用户自定义的Jekyll plugins）。</li>
<li>不过需要用到自己的plugins的时候，一般都会把站点托管在自己的服务器或者Heroku这种地方吧……所以这项功能总的来说还是会比较有用的。</li>
</ul></li>
<li><p>支持RDiscount的行内目录（TOC）生成</p>

<ul>
<li>使用RDiscount引擎的时候会用到。</li>
</ul></li>
<li><p>增加了用于指定分页URL格式的选项</p>

<ul>
<li>需要对博客文章进行分页控制的时候也许会有用。</li>
</ul></li>
<li><p>改进了Liquid错误的提示信息</p></li>
</ul>

<h2>参考资料</h2>

<ul>
<li><a href="http://tech.nitoyon.com/ja/blog/2012/12/25/jekyll-0-12-0/">http://tech.nitoyon.com/ja/blog/2012/12/25/jekyll-0-12-0/</a></li>
<li><a href="https://github.com/mojombo/jekyll/blob/master/History.txt">https://github.com/mojombo/jekyll/blob/master/History.txt</a></li>
</ul>

    </article>
    
    
    <article id="articlePost" style="padding-bottom: 0">
        <div id="divDisqus">
            <div id="disqus_thread"></div>
            <script type="text/javascript">
                var disqus_shortname = 'soimort';
                
                var disqus_url = 'http://www.soimort.org/posts/130/index.html';
                
                
                (function() {
                    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                    dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
                    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                })();
            </script>
            <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
            <a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>
        </div>
    </article>
    
</div>


</body>
</html>
